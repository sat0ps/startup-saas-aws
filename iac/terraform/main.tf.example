terraform {
  required_version = ">= 1.6.0"
  required_providers { aws = { source = "hashicorp/aws", version = "~> 5.0" } }
}

# provider "aws" {}  # omitted on purpose (portfolio only)

module "vpc" {
  source          = "./modules/vpc"
  name            = "brian-portfolio-vpc"
  cidr            = "10.30.0.0/16"
  azs             = ["us-east-1a","us-east-1b"]
  public_subnets  = ["10.30.0.0/24","10.30.1.0/24"]
  private_subnets = ["10.30.10.0/24","10.30.11.0/24"]
}

module "eks" {
  source               = "./modules/eks"
  cluster_name         = "brian-portfolio-eks"
  kubernetes_version   = "1.29"
  subnet_ids           = module.vpc.private_subnet_ids
  node_instance_types  = ["t3.large"]
  desired_size         = 1
  min_size             = 1
  max_size             = 3
}

module "ecr" {
  source = "./modules/ecr"
  name   = "brian-app"
}
